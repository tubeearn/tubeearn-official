<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Owner Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    body{margin:0;font-family:sans-serif;background:#f5f7fa;display:flex;min-height:100vh;}
    .sidebar{width:220px;background:#1e293b;color:#fff;padding:20px;}
    .sidebar h2{margin-bottom:20px;}
    .sidebar li{padding:10px 0;cursor:pointer;}
    .sidebar li:hover{background:#334155;}
    .main{flex:1;padding:20px;}
    .topbar{background:#fff;padding:15px;box-shadow:0 2px 5px rgba(0,0,0,0.1);}
    .content{margin:20px 0;}
    .card{background:#fff;border-radius:8px;padding:15px;box-shadow:0 2px 8px rgba(0,0,0,0.05);margin-bottom:15px;}
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>TubeEarn Owner</h2>
    <ul>
      <li onclick="loadOverview()">Dashboard</li>
      <li onclick="loadWallet()">Wallet</li>
      <li onclick="logout()">Logout</li>
    </ul>
  </div>
  <div class="main">
    <div class="topbar"><strong>Logged in as:</strong> tubeearn.help@gmail.com</div>
    <div class="content" id="mainContent"></div>
  </div>

  <script>
    const supabaseClient = supabase.createClient(
      'https://ejbvidirnsjvadvekede.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI...ARkrRqb_GXlGfUs'
    );
    supabaseClient.auth.onAuthStateChange((_, session) => {
      if (!session) location.href = 'index.html';
    });

    async function loadOverview() {
      const { data, error } = await supabaseClient.from('wallet-transactions').select('*');
      let total = 0;
      data.forEach(t => total += t.amount);
      document.getElementById('mainContent').innerHTML = `
        <div class="card"><h3>Total Balance</h3><p>â‚¹ ${total}</p></div>
        <div class="card"><h3>Transactions Count</h3><p>${data.length}</p></div>
      `;
    }

    function loadWallet() { loadOverview(); }
    function logout(){ supabaseClient.auth.signOut().then(()=>location.href='index.html'); }

    loadOverview();
  </script>
</body>
</html>
